
---
alwaysApply: true
---

# Git 操作权限控制

## 核心原则

**⚠️ 重要：除非用户明确指示或触发特定操作，否则不得执行任何 Git 命令**

## 自动执行的特殊情况

### 每次回答完成后自动本地提交
当AI完成对用户问题的回答后，如果有代码更改：
- **自动执行**：`git add .` - 添加所有更改到暂存区
- **自动执行**：`git commit -m "提交描述"` - 提交到本地仓库
- **不执行**：`git push` - 不推送到远程仓库

**注意**：每个问答回合结束时自动提交，确保每次交互的成果都被及时保存。

## 需要明确授权的命令

### 绝对禁止自动执行（除非上述特殊情况）
- `git add` - 添加文件到暂存区（除非回答完成）
- `git commit` - 提交更改（除非回答完成）
- `git push` - 推送到远程仓库
- `git pull` - 拉取远程更改
- `git merge` - 合并分支
- `git rebase` - 变基操作
- `git reset` - 重置操作
- `git checkout` - 切换分支
- `git branch` - 创建/删除分支

### 允许的只读操作
- `git status` - 查看状态
- `git log` - 查看历史
- `git diff` - 查看差异
- `git remote -v` - 查看远程仓库
- `git branch -l` - 列出分支

## 明确指示的识别

用户必须使用以下明确的词语才能执行需要授权的 Git 操作：

### 中文指示
- "提交代码"
- "推送代码" 
- "创建分支"
- "合并分支"
- "添加文件"
- "git 提交"
- "git 推送"

### 英文指示
- "git add"
- "git commit"
- "git push"
- "commit the changes"
- "push to repository"

## 工作流程

### 每次回答完成自动提交流程
1. **用户提问** - 用户提出问题或请求
2. **AI处理** - AI理解并执行各种代码编辑操作
3. **回答完成** - AI完成回答，准备结束本轮交互
4. **自动检查** - 检查是否有代码更改
5. **自动执行** - `git add .` 添加所有更改
6. **自动执行** - `git commit -m "..."` 提交到本地
7. **完成** - 本地提交完成，等待下一个问题

### 手动推送流程
1. **代码更改** - 已通过回答完成自动提交到本地
2. **用户指示** - 明确表示"推送代码"或"git push"
3. **执行操作** - `git push` 推送到远程仓库

### 其他 Git 操作流程
1. **代码更改** - 自动执行编辑操作
2. **询问用户** - "是否需要提交这些更改？"
3. **等待确认** - 用户明确表示"提交代码"
4. **执行操作** - 按用户指示执行 git 命令

### 错误做法
❌ 在回答未完成时自动执行：`git add . && git commit -m "..."`
❌ 假设用户意图：认为更改完成就应该提交
❌ 回答完成后自动推送：`git push`

## 特殊情况

### 主动建议的情况
只有在以下情况下可以主动建议（但不执行）git 操作：
- 用户明确询问如何提交代码
- 发现工作区有大量未提交的更改
- 用户要求查看 git 状态

### 建议措辞
- 回答完成后："代码已自动提交到本地仓库。如需推送到远程，请告诉我'推送代码'。"
- 手动更改后："您的更改已完成。如果需要提交代码，请告诉我'提交代码'。"

## 记忆要点

这个规则确保：
- 每次回答完成后触发便捷的本地版本控制
- 用户对远程推送有完全的控制权
- 避免意外的远程代码推送
- 保持工作流程的透明性和可控性
- 确保每次交互成果都被及时保存
- 尊重用户的开发节奏和决策

**核心原则：每次回答完成后自动提交，明确指令才推送远程。**


**记住：当不确定时，总是选择询问而不是执行。**

---
description: Solidity compiler compatibility and Apple Silicon support
globs: "*.sol,foundry.toml,*.md"
---

# Solidity Apple Silicon å…¼å®¹æ€§æŒ‡å—

## ç‰ˆæœ¬ç­–ç•¥
- **ç›®æ ‡ç‰ˆæœ¬**: Solidity 0.8.19 (Apple Silicon åŸç”Ÿæ”¯æŒ)
- **EVM ç‰ˆæœ¬**: shanghai
- **ç¼–è¯‘å™¨**: Foundry 1.2.3+

## é¡¹ç›®æ¨¡å—çŠ¶æ€

### âœ… å®Œå…¨å‡çº§æ¨¡å—
- **Treasury** ([contracts/treasury/](mdc:contracts/treasury/)): å®Œå…¨å‡çº§åˆ° 0.8.19
  - ç§»é™¤ SafeMath è°ƒç”¨ï¼Œä½¿ç”¨å†…ç½®æº¢å‡ºæ£€æŸ¥
  - ç§»é™¤ `pragma experimental ABIEncoderV2`
  - æ„é€ å‡½æ•°è¯­æ³•ç°ä»£åŒ–
- **Governance** ([contracts/governance/](mdc:contracts/governance/)): åŸç”Ÿ 0.8.19 æ”¯æŒ

### ğŸ”„ æ··åˆç‰ˆæœ¬æ¨¡å—
- **ERC20** ([contracts/erc20/](mdc:contracts/erc20/)): ç°ä»£åŒ– + é—ç•™åˆ†ç¦»
  - `src/` - ç°ä»£åŒ–åˆçº¦ (0.8.19)
  - `legacy_contracts/` - é—ç•™åˆçº¦ (0.4.11, 0.5.9, 0.6.x)

## Apple Silicon è§£å†³æ–¹æ¡ˆ

### é—®é¢˜è¯†åˆ«
å¦‚æœé‡åˆ° `Bad CPU type in executable (os error 86)` é”™è¯¯ï¼š
- è¡¨ç¤ºå°è¯•ä½¿ç”¨ä¸å…¼å®¹ ARM64 çš„ä½ç‰ˆæœ¬ç¼–è¯‘å™¨
- éœ€è¦å‡çº§åˆ° 0.8.0+ ç‰ˆæœ¬

### å¤„ç†ç­–ç•¥
1. **ä¼˜å…ˆå‡çº§**: å‡çº§åˆçº¦åˆ° 0.8.19
2. **åˆ†ç¦»ç­–ç•¥**: å°†ä¸å…¼å®¹åˆçº¦ç§»è‡³ `legacy_contracts/`
3. **æ–‡æ¡£è®°å½•**: åˆ›å»º `README_APPLE_SILICON.md` è¯´æ˜

## å‡çº§æ¸…å•
å‡çº§åˆçº¦æ—¶å¿…é¡»å¤„ç†ï¼š
- [ ] æ›´æ–° pragma ç‰ˆæœ¬
- [ ] ç§»é™¤ SafeMath åº“è°ƒç”¨
- [ ] ç§»é™¤ `pragma experimental ABIEncoderV2`
- [ ] ä¿®å¤æ„é€ å‡½æ•°è¯­æ³• (`public` â†’ ç§»é™¤)
- [ ] æ£€æŸ¥ `chainid()` å‡½æ•°å¯è§æ€§ (`pure` â†’ `view`)
- [ ] æ›´æ–° foundry.toml é…ç½®

å‚è€ƒå‡çº§ç¤ºä¾‹: [contracts/treasury/contracts/src/ZrxTreasury.sol](mdc:contracts/treasury/contracts/src/ZrxTreasury.sol)

# Contract-Artifacts åŒ…ç®€åŒ–å®ŒæˆæŠ¥å‘Š

## ğŸ¯ **ç®€åŒ–ç›®æ ‡**

å°† `@0x/contract-artifacts` åŒ…ä»å¤æ‚çš„ abi-gen å…¼å®¹æ ¼å¼è½¬æ¢ï¼Œç®€åŒ–ä¸ºç›´æ¥ä½¿ç”¨ **Hardhat åŸç”Ÿæ ¼å¼**ï¼Œå®ç°é›¶è½¬æ¢çš„ TypeChain å…¼å®¹æ€§ã€‚

## âœ… **å®Œæˆçš„ç®€åŒ–**

### ğŸ—‘ï¸ **ç§»é™¤çš„å¤æ‚æ€§**

#### **1. åˆ é™¤è½¬æ¢æ­¥éª¤**

-   âŒ ç§»é™¤ `src/transform.ts` - ä¸å†éœ€è¦æ ¼å¼è½¬æ¢
-   âŒ ç§»é™¤ `src/copy.ts` - ç®€åŒ–ä¸ºçº¯ JavaScript è„šæœ¬
-   âŒ ç§»é™¤ `artifacts_transform` è„šæœ¬ - ç›´æ¥å¤åˆ¶å³å¯

#### **2. ç®€åŒ–æ„å»ºæµç¨‹**

**å‡çº§å‰**:

```bash
artifacts_copy â†’ artifacts_transform â†’ prettier â†’ build
```

**å‡çº§å**:

```bash
artifacts_copy â†’ build  # å°±è¿™ä¹ˆç®€å•ï¼
```

#### **3. ç§»é™¤ä¾èµ–çš„è½¬æ¢é€»è¾‘**

-   åˆ é™¤ `deleteNestedProperty` è½¬æ¢
-   åˆ é™¤ `convertHardhatArtifact` è½¬æ¢
-   åˆ é™¤ `removeForbiddenProperties` æ¸…ç†

### ğŸš€ **æ–°çš„ç®€åŒ–æ¶æ„**

#### **1. ç›´æ¥å¤åˆ¶ç­–ç•¥**

```javascript
// åŸæ¥ï¼šå¤æ‚è½¬æ¢
artifact = convertHardhatArtifact(rawArtifact);
cleaned = removeForbiddenProperties(artifact);

// ç°åœ¨ï¼šç›´æ¥å¤åˆ¶
fs.copyFileSync(source, target); // å°±è¿™ä¹ˆç®€å•ï¼
```

#### **2. é›¶è½¬æ¢æµç¨‹**

```bash
contracts/*/artifacts/*.json â†’ packages/contract-artifacts/artifacts/*.json
#                ç›´æ¥å¤åˆ¶ï¼Œä¿æŒ Hardhat åŸç”Ÿæ ¼å¼
```

#### **3. TypeChain åŸç”Ÿå…¼å®¹**

```typescript
// ç°åœ¨çš„ artifacts ç›´æ¥å°±æ˜¯ TypeChain éœ€è¦çš„æ ¼å¼
{
  "_format": "hh-sol-artifact-1",
  "contractName": "IERC20Token",
  "abi": [...],
  "bytecode": "0x...",
  "deployedBytecode": "0x..."
}
```

## ğŸ“Š **ç®€åŒ–æˆæœç»Ÿè®¡**

### **ä»£ç é‡å‡å°‘**

-   **åˆ é™¤æ–‡ä»¶**: 2 ä¸ª (`transform.ts`, `copy.ts`)
-   **ç®€åŒ–è„šæœ¬**: `copy-artifacts.js` ä» 201 è¡Œå‡å°‘åˆ° çº¦ 140 è¡Œ
-   **ç§»é™¤ä¾èµ–**: ä¸å†éœ€è¦å¤æ‚çš„è½¬æ¢é€»è¾‘

### **æ„å»ºæ—¶é—´ä¼˜åŒ–**

-   **è½¬æ¢æ­¥éª¤**: ä» 3 æ­¥éª¤å‡å°‘åˆ° 1 æ­¥éª¤
-   **å¤„ç†æ—¶é—´**: å‡ ä¹ç¬æ—¶å®Œæˆï¼ˆçº¯æ–‡ä»¶å¤åˆ¶ï¼‰
-   **å†…å­˜ä½¿ç”¨**: å¤§å¹…å‡å°‘ï¼ˆæ— éœ€è§£æå’Œé‡æ„ JSONï¼‰

### **ç»´æŠ¤æˆæœ¬é™ä½**

-   **è°ƒè¯•å¤æ‚åº¦**: å¤§å¹…é™ä½
-   **é”™è¯¯ç‚¹**: ä»å¤šä¸ªè½¬æ¢ç¯èŠ‚å‡å°‘åˆ°å•ä¸€å¤åˆ¶æ“ä½œ
-   **æ–‡æ¡£æ›´æ–°**: ç®€åŒ–çš„æµç¨‹æ›´æ˜“ç†è§£

## ğŸ¯ **æŠ€æœ¯æ”¶ç›Š**

### **å¼€å‘ä½“éªŒ**

-   âœ… **é›¶é…ç½®**: ä¸éœ€è¦å¤æ‚çš„è½¬æ¢é…ç½®
-   âœ… **é›¶è°ƒè¯•**: ç›´æ¥å¤åˆ¶ï¼Œä¸ä¼šå‡ºç°è½¬æ¢é”™è¯¯
-   âœ… **é›¶å»¶è¿Ÿ**: ç¬æ—¶å®Œæˆï¼Œä¸éœ€è¦ç­‰å¾…è½¬æ¢

### **TypeChain å…¼å®¹æ€§**

-   âœ… **100% å…¼å®¹**: Hardhat åŸç”Ÿæ ¼å¼å°±æ˜¯ TypeChain æ ‡å‡†
-   âœ… **BigInt åŸç”Ÿæ”¯æŒ**: æ— éœ€é¢å¤–è½¬æ¢
-   âœ… **Ethers v6 ç›´æ¥æ”¯æŒ**: å®Œç¾é›†æˆ

### **ç”Ÿäº§ç¨³å®šæ€§**

-   âœ… **æ›´å°‘æ•…éšœç‚¹**: ç®€åŒ–çš„æµç¨‹å‡å°‘å‡ºé”™æ¦‚ç‡
-   âœ… **æ›´å¿«æ„å»º**: CI/CD æµç¨‹æ›´é«˜æ•ˆ
-   âœ… **æ›´æ˜“ç»´æŠ¤**: æ–°å›¢é˜Ÿæˆå‘˜å¿«é€Ÿç†è§£

## ğŸ“‹ **ä½¿ç”¨ç¤ºä¾‹**

### **å¼€å‘è€…ä½¿ç”¨**

```typescript
import * as artifacts from '@0x/contract-artifacts';
import { IERC20Token__factory } from '@0x/contract-wrappers';

// ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€è½¬æ¢
const contract = IERC20Token__factory.connect(address, provider);
const balance: bigint = await contract.balanceOf(user); // åŸç”Ÿ bigintï¼
```

### **æ„å»ºæµç¨‹**

```bash
# 1. ç¼–è¯‘åˆçº¦ (å„åˆçº¦åŒ…)
hardhat compile

# 2. å¤åˆ¶ artifacts (é›¶è½¬æ¢)
yarn artifacts_copy

# 3. æ„å»ºåŒ…
yarn build

# å°±è¿™ä¹ˆç®€å•ï¼
```

## ğŸ”„ **è¿ç§»å½±å“**

### **å¯¹ contract-wrappers çš„å½±å“**

-   âœ… **å®Œå…¨å…¼å®¹**: TypeChain ç›´æ¥ä½¿ç”¨è¿™äº› artifacts
-   âœ… **æ€§èƒ½æå‡**: æ›´å¿«çš„ç±»å‹ç”Ÿæˆ
-   âœ… **æ›´å¥½çš„ç±»å‹**: åŸç”Ÿ Hardhat æ ¼å¼æä¾›æ›´å‡†ç¡®çš„ç±»å‹ä¿¡æ¯

### **å¯¹å…¶ä»–åŒ…çš„å½±å“**

-   âœ… **å‘åå…¼å®¹**: ä¿æŒç›¸åŒçš„å¯¼å…¥ API
-   âœ… **æ›´å¥½çš„ DX**: æ›´æ¸…æ™°çš„ artifact ç»“æ„
-   âœ… **æ›´å°çš„åŒ…**: å‡å°‘ä¸å¿…è¦çš„å…ƒæ•°æ®

## ğŸ‰ **æ€»ç»“**

é€šè¿‡è¿™æ¬¡ç®€åŒ–ï¼Œ`@0x/contract-artifacts` åŒ…ä»ä¸€ä¸ªå¤æ‚çš„è½¬æ¢å·¥å…·ï¼Œå˜æˆäº†ä¸€ä¸ªç®€å•è€Œé«˜æ•ˆçš„ Hardhat artifacts åˆ†å‘åŒ…ã€‚

**æ ¸å¿ƒç†å¿µå˜åŒ–**:

-   **ä»**: "è½¬æ¢ artifacts ä»¥é€‚é… abi-gen"
-   **åˆ°**: "ç›´æ¥ä½¿ç”¨ Hardhat æ ‡å‡†æ ¼å¼"

**ç»“æœ**: æ›´ç®€å•ã€æ›´å¿«ã€æ›´å¯é çš„å·¥å…·é“¾ï¼
